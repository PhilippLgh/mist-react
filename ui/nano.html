<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://unpkg.com/buefy/dist/buefy.min.css">
    <style>
      html, body {
        padding: 0px;
        margin: 0px;
        background-color: #1E1E1E;
        overflow: hidden;
      }
      body {
        min-height: 100vh;
      }
    </style>
    <style>
      .switch input[type=checkbox]:checked+.check {
          background: #57d57e;
      }
      .switch:hover input[type=checkbox]:checked+.check {
          background: rgba(87,213, 126, .9);
      }
      .switch input[type=checkbox]:focus:checked+.check {
        box-shadow: 0 0 0.5em rgba(87,213, 126,.8);
      }

      .switch input[type=checkbox]+.check {
        background: #3e3e3e;
      }

      #app {
        padding: 10px;
      }

      .client-item {
        padding: 5px;
        display: flex;
        color: white;
      }

      .client-name {
        margin-right: 5px;
      }

      .client-profile {
        color: #44a1d9;
        margin-right: 5px;
      }

      span.centered {
        display: inline-flex;
        align-items: center;
      }

      .client-version {
        line-height: 1rem;
        font-size: .8rem;
        color: #555;
        visibility: hidden;
      }

      .client-item:hover .client-version {
        visibility: visible;
      }

      .spacer {
        flex-grow: 1;
      }
    </style>
</head>

<body>
    <div id="app">
      <client-item v-for="client in clients" :client="client"></client-item>
    </div>

    <script src="https://unpkg.com/vue"></script>
    <!-- Full bundle -->
    <script src="https://unpkg.com/buefy/dist/buefy.min.js"></script>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/all.css">

    <script>

        Vue.component('profile-select', {
          template: `
          <b-dropdown aria-role="list">
        <button size="is-small" class="button is-primary" slot="trigger">
            <span>Click me!</span>
            <b-icon pack="fas" icon="caret-down"></b-icon>
        </button>
        <b-dropdown-item aria-role="listitem">Action</b-dropdown-item>
        <b-dropdown-item aria-role="listitem">Another action</b-dropdown-item>
        <b-dropdown-item aria-role="listitem">Something else</b-dropdown-item>
      </b-dropdown>
          `
        })

        Vue.component('client-item', {
          props: ['client'],
          template: `
            <div class="client-item">
              <span class="client-name">{{ client.name }}</span>
              <span class="client-profile">{{ client.profile }}</span>
              <span class="client-version centered">{{ client.version }}</span>
              <div class="spacer"></div>
              <b-switch v-model="isSwitched" size="is-small">
              </b-switch>
              <b-button 
                size="is-small"
                icon-pack="fas"
                icon-left="cog"
                v-on:click="say('hi')"
              >
              </b-button>
              <b-button 
                size="is-small"
                icon-pack="fas"
                icon-left="terminal"
                v-on:click="say('hi')"
              >
              </b-button>
            </div>
          `,
          methods: {
            say: function (message) {
              alert(message)
            }
          }
        })

        new Vue({
          el: '#app',
          data: {
            clients: [],
            isSwitched: false
          },
          mounted: async function(){
            try {
              const plugins = window.Grid.PluginHost.getAllPlugins()
              this.clients = plugins.map(p => ({
                name: p.displayName,
                profile: '',
                version: ''
              }))
              console.log('plugins loaded', plugins.length)
            } catch (error) {
              console.log('error loading plugins', error)          
            }
          } 
        })
    </script>
</body>
</html>